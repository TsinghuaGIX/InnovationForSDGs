{"version":"V2.0","versionNumber":"V2.0.9","type":"cores3","components":[{"name":"screen","type":"screen","layer":0,"screenId":"builtin","screenName":"","id":"__cores3_screen","createTime":1721021426331,"x":0,"y":0,"width":320,"height":240,"backgroundColor":"#222222","size":0,"isSelected":true}],"resources":[{"hardware":["hardware_button","hardware_pin_button","imu","speaker","touch","als","mic"]},{"unit":["unit_rgb"]},{"custom":["custom_colorutils"]}],"units":[{"type":"unit_rgb","name":"rgb_0","portList":["A","B","C","Custom"],"portType":"B","userPort":[22,21],"id":"fiA`*!TJ``hLu%9D","createTime":1721196738158,"initBlockId":"[Lv2x]3ZYC)N,w%8,Ym}"}],"hats":[],"bases":[],"i2cs":[],"blockly":"<variables><variable id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</variable><variable id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</variable><variable id=\"cpi%9I;;JB;$v^8K)J#6\">i</variable><variable id=\"7T:={M6hkR9]2_Y%;A^0\">rgb_list</variable><variable id=\"_9n2lL[heO46KrP,DsOc\">R</variable><variable id=\"IoL|NI7p|7r!sRWUJ~#u\">G</variable><variable id=\"}d%QV|u26K-O1dN8D905\">B</variable></variables><block type=\"basic_on_setup\" id=\"setup_block\" deletable=\"false\" x=\"-50\" y=\"30\"><mutation isBegin=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"system_m5_begin\" id=\"system_m5_begin\"><next><block type=\"unit_rgb_init\" id=\"[Lv2x]3ZYC)N,w%8,Ym}\"><field name=\"NAME\">rgb_0</field><value name=\"NUMBER\"><shadow type=\"math_number\" id=\"#517GV~U2aPohf@;DnBv\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">37</field></shadow></value><next><block type=\"custom_colorutils_init\" id=\"i~;X_g?:NrUkL~C!jx,m\"><field name=\"NAME\">colorutils_0</field><next><block type=\"unit_rgb_set_brightness\" id=\"y(WWXNoaK6]LMbZe6{p#\"><field name=\"NAME\">rgb_0</field><value name=\"BRIGHTNESS\"><shadow type=\"math_slider\" id=\"7ivRtAO8E0v.hT8HhkL2\"><mutation max=\"100\" min=\"0\" step=\"1\" precision=\"1\"></mutation><field name=\"NUM\">10</field></shadow></value><next><block type=\"variables_set\" id=\"R3yyZwYq)q0[EOagg~]3\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field><value name=\"VALUE\"><block type=\"math_number\" id=\";[;HRElYKtK]x3:c:*|z\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">0</field></block></value></block></next></block></next></block></next></block></next></block></statement></block><block type=\"procedures_defnoreturn\" id=\"9kF*-Re^:;i!$xyjzd8*\" x=\"410\" y=\"30\"><field name=\"NAME\">update_rgb_color</field><comment pinned=\"false\" h=\"80\" w=\"160\">Describe this function...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"W.R=5y[Oac$W3eb;$Hx+\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field><value name=\"VALUE\"><block type=\"variables_get\" id=\"H}4`Hlm%FydC}9E!UXN/\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field></block></value><next><block type=\"controls_for\" id=\"!bc3.$KxxUpD}l^DC3=I\"><field name=\"VAR\" id=\"cpi%9I;;JB;$v^8K)J#6\">i</field><value name=\"FROM\"><shadow type=\"math_number\" id=\",2AnR}n}B6r`^8d_aW$z\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">0</field></shadow></value><value name=\"TO\"><shadow type=\"math_number\" id=\"c]zgO$TggW,aPIfBA/R[\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">36</field></shadow></value><value name=\"BY\"><shadow type=\"math_number\" id=\"b+F?mu1?3ijylNz5be!C\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\" id=\"!C75oYXP{3yOD#`BQ`D2\"><field name=\"VAR\" id=\"7T:={M6hkR9]2_Y%;A^0\">rgb_list</field><value name=\"VALUE\"><block type=\"custom_colorutils_hsv2rgb\" id=\"6=,C:-`7o]aP@c((!CB?\"><field name=\"NAME\">colorutils_0</field><value name=\"hue\"><shadow type=\"math_number\" id=\"H!MSgs@Y7GnLxM_(k(JK\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">0</field></shadow><block type=\"variables_get\" id=\"cm)A_IVq?yzKCd7g{UaG\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field></block></value><value name=\"val\"><shadow type=\"math_number\" id=\"W`_[%|}t^HFhByjDqsHq\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow></value><value name=\"sat\"><shadow type=\"math_number\" id=\"7u$rf5!2Nsxt7j!j0{Be\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow></value></block></value><next><block type=\"variables_set\" id=\"0NF2d/Bd?CC[6=NVy_.7\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field><value name=\"VALUE\"><block type=\"math_arithmetic\" id=\"J;qj1d[)eSd/AKSj{Y::\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\" id=\"t)5%{VS1K+zK2[7osUp#\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\"+=f^wZAnuNHYczK87C08\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field></block></value><value name=\"B\"><shadow type=\"math_number\" id=\"Le0L7;[3(!dF6Z=-WDwK\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">10</field></shadow></value></block></value><next><block type=\"variables_set\" id=\"ZO7U.7#kejpvK;16SS{!\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field><value name=\"VALUE\"><block type=\"math_arithmetic\" id=\"QHIheuk^sl=@kh=;Fv}*\"><field name=\"OP\">REMAINDER</field><value name=\"A\"><shadow type=\"math_number\" id=\"#4nH+bytCKy`U{k]nTf*\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\"*/lQQQ[^2sr[)bD)E)le\"><field name=\"VAR\" id=\"7s},1?ggOLMj`Yg6U-A1\">locHue</field></block></value><value name=\"B\"><shadow type=\"math_number\" id=\"_^;){Ya_|*rIT#wy(1*I\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">360</field></shadow></value></block></value><next><block type=\"variables_set\" id=\"jF[st65RS_AH9:!~^^0O\"><field name=\"VAR\" id=\"_9n2lL[heO46KrP,DsOc\">R</field><value name=\"VALUE\"><block type=\"lists_getIndex\" id=\"a6ZvINnG4`g0B!Uoc;sx\"><mutation statement=\"false\" at=\"true\"></mutation><field name=\"MODE\">GET</field><field name=\"WHERE\">FROM_START</field><value name=\"VALUE\"><block type=\"variables_get\" id=\")TnNXEYx$.zSpe_b@MJd\"><field name=\"VAR\" id=\"7T:={M6hkR9]2_Y%;A^0\">rgb_list</field></block></value><value name=\"AT\"><block type=\"math_number\" id=\"(h0#/^ER1N7mP+aTegBR\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">0</field></block></value></block></value><next><block type=\"variables_set\" id=\"g{5Xx[9Kn6yNThmGmyC{\"><field name=\"VAR\" id=\"IoL|NI7p|7r!sRWUJ~#u\">G</field><value name=\"VALUE\"><block type=\"lists_getIndex\" id=\"jUPu1g5#Xmz{^T#1:B)/\"><mutation statement=\"false\" at=\"true\"></mutation><field name=\"MODE\">GET</field><field name=\"WHERE\">FROM_START</field><value name=\"VALUE\"><block type=\"variables_get\" id=\"11gFa^|G#qEnSr9(bNI]\"><field name=\"VAR\" id=\"7T:={M6hkR9]2_Y%;A^0\">rgb_list</field></block></value><value name=\"AT\"><block type=\"math_number\" id=\"xhG`6iUQoo#!nx?q|46C\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></block></value></block></value><next><block type=\"variables_set\" id=\"|XW:r89T!GiD#CH/OM^-\"><field name=\"VAR\" id=\"}d%QV|u26K-O1dN8D905\">B</field><value name=\"VALUE\"><block type=\"lists_getIndex\" id=\"B+MiX76VszkG4OCI`pr?\"><mutation statement=\"false\" at=\"true\"></mutation><field name=\"MODE\">GET</field><field name=\"WHERE\">FROM_START</field><value name=\"VALUE\"><block type=\"variables_get\" id=\"|[RqfI|ZmrR2?%/YJn.}\"><field name=\"VAR\" id=\"7T:={M6hkR9]2_Y%;A^0\">rgb_list</field></block></value><value name=\"AT\"><block type=\"math_number\" id=\"-CM(|4mLF?O%g94nCl42\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">2</field></block></value></block></value><next><block type=\"unit_rgb_set_index_color\" id=\"SVxa:0TND5B_N{T)`y?T\"><field name=\"NAME\">rgb_0</field><value name=\"INDEX\"><shadow type=\"math_number\" id=\"2+;^gX4_N?D^|ur-g~0y\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">0</field></shadow><block type=\"variables_get\" id=\"-)U}$qt$PFHV4!FLOYyy\"><field name=\"VAR\" id=\"cpi%9I;;JB;$v^8K)J#6\">i</field></block></value><value name=\"COLOR\"><block type=\"color_rgb_palette\" id=\"D[h1t^]9K!*~(JS(/|bo\"><mutation mode=\"rgb\"></mutation><field name=\"MODE\">rgb</field><value name=\"R\"><shadow type=\"math_slider\" id=\"^C$Jqxq)5Zg.mr:J6s;w\"><mutation max=\"255\" min=\"0\" step=\"1\" precision=\"1\"></mutation><field name=\"NUM\">0</field></shadow><block type=\"variables_get\" id=\".*~9,lOlrroLki9CMr-T\"><field name=\"VAR\" id=\"_9n2lL[heO46KrP,DsOc\">R</field></block></value><value name=\"G\"><shadow type=\"math_slider\" id=\"Z-)$WhlxfK-WpcSK``5^\"><mutation max=\"255\" min=\"0\" step=\"1\" precision=\"1\"></mutation><field name=\"NUM\">0</field></shadow><block type=\"variables_get\" id=\"o/|p]rR:K*%X*%XW/c?[\"><field name=\"VAR\" id=\"IoL|NI7p|7r!sRWUJ~#u\">G</field></block></value><value name=\"B\"><shadow type=\"math_slider\" id=\"m}lX508zmQ%W7o-(9Q;@\"><mutation max=\"255\" min=\"0\" step=\"1\" precision=\"1\"></mutation><field name=\"NUM\">0</field></shadow><block type=\"variables_get\" id=\"jzm7P9s5g8Qd0]1tTeiC\"><field name=\"VAR\" id=\"}d%QV|u26K-O1dN8D905\">B</field></block></value></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></next></block></statement></block><block type=\"basic_on_loop\" id=\"loop_block\" deletable=\"false\" x=\"-210\" y=\"430\"><mutation isUpdate=\"true\"></mutation><field name=\"UPDATEOP\">true</field><statement name=\"FUNC\"><block type=\"procedures_callnoreturn\" id=\"bc4StbO/*)N_9w^i$spi\"><mutation name=\"update_rgb_color\"></mutation><next><block type=\"variables_set\" id=\";E{,?X.rx=LF+vsqz5bq\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field><value name=\"VALUE\"><block type=\"math_arithmetic\" id=\",eP=m2Pq3g.#?ig$*%YI\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\" id=\"Ya%-(N:TYeXU%#NCFHHG\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\"m.T|L}0;)K|y*yeFy|pd\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field></block></value><value name=\"B\"><shadow type=\"math_number\" id=\"^:%iPoynsQDb^HMgGq9x\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">10</field></shadow></value></block></value><next><block type=\"variables_set\" id=\"sU[+IC6bhzR!-]$NXpj[\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field><value name=\"VALUE\"><block type=\"math_arithmetic\" id=\"8Y.]k]Ba(fG@X?U|zUxa\"><field name=\"OP\">REMAINDER</field><value name=\"A\"><shadow type=\"math_number\" id=\"Y;5JmF0~LA5}P_~U]A]f\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">1</field></shadow><block type=\"variables_get\" id=\"(/}zn%BH3e,VB1ZQf:Sr\"><field name=\"VAR\" id=\"Sa}kPD9Gk/I5:r3-0OB!\">gHue</field></block></value><value name=\"B\"><shadow type=\"math_number\" id=\"XW19ni4p!7?pd_=:C}]t\"><mutation max=\"Infinity\" min=\"-Infinity\" precision=\"0\"></mutation><field name=\"NUM\">360</field></shadow></value></block></value><next><block type=\"time_sleep_millisecond\" id=\"C4[Q`b-IcW+}?Q_L[$GM\"><value name=\"MS\"><shadow type=\"math_number\" id=\"tv,IZLF;oJ{7S5xuv0I/\"><mutation max=\"Infinity\" min=\"0\" precision=\"0\"></mutation><field name=\"NUM\">20</field></shadow></value><next><block type=\"system_m5_update\" id=\"system_m5_update\"></block></next></block></next></block></next></block></next></block></statement></block>","screen":[{"simulationName":"Built-in","type":"builtin","width":320,"height":240,"scale":0.78,"screenName":"","blockId":"","screenColorType":0,"id":"builtin","createTime":1721021426329}],"logicWhenNum":0,"customList":[{"id":"custom_colorutils","name":"ColorUtils","color":"#0FB1D2","blockly":"const CUSTOM_COLORUTILS_LANGUAGES = {\n  \"CUSTOM_COLORUTILS_INIT\": {\n    \"en\": \"%1 init\"\n  },\n  \"CUSTOM_COLORUTILS_HSV2RGB\": {\n    \"en\": \"HSV2RGB %1 hue %2 val %3 sat %4\"\n  }\n};\n\nconst initType = 'custom_colorutils_init';\nBlockly.BlockRegExpList['custom_colorutils'] = {\n  regexp: new RegExp(/^custom_colorutils_/),\n  code: \"from colorutils import ColorUtils\",\n  initBlockType: initType,\n  categoryId: 'custom_colorutils',\n}\nBlockly.utils.registerLanguages(CUSTOM_COLORUTILS_LANGUAGES)\n\nBlockly.Msg.CUSTOM_COLORUTILS_HUE = '#0FB1D2'\nBlockly.Msg.CUSTOM_COLORUTILS = 'ColorUtils'\n\nBlockly.utils.getcustom_colorutilsOptions = function() {\n  let options = [];\n  let list = Blockly.utils.getCustomNameList(initType);\n  for (let i = 0; i < list.length; i++) {\n    let value = list[i];\n    options.push([String(value), String(value)]);\n  }\n  if (options.length === 0) return [\n    ['colorutils_0', 'colorutils_0']\n  ];\n  return options;\n}\n\n\nBlockly.Blocks[\"custom_colorutils_init\"] = {\n  init: function() {\n    this.jsonInit(this._init());\n  },\n  _init: function() {\n    return {\n      'message0': Blockly.Msg.CUSTOM_COLORUTILS_INIT,\n      'args0': [\n        // { 'type': 'field_dropdown', 'name': 'NAME', 'options': Blockly.utils.getcustom_colorutilsOptions },\n        {\n          'type': 'field_input',\n          'name': 'NAME',\n          'text': 'colorutils_0'\n        },\n\n      ],\n      'previousStatement': null,\n      'nextStatement': null,\n      'inputsInline': true,\n      'colour': \"#0FB1D2\",\n      \"tool\": []\n    };\n  }\n}\n\nBlockly.Python[\"custom_colorutils_init\"] = function(block) {\n  var varname = block.getFieldValue('NAME') || '_';\n\n  return `${varname} = ColorUtils()\\n`\n}\n\nBlockly.Blocks[\"custom_colorutils_hsv2rgb\"] = {\n  init: function() {\n    this.jsonInit(this._init());\n  },\n  _init: function() {\n    return {\n      'message0': Blockly.Msg.CUSTOM_COLORUTILS_HSV2RGB,\n      'args0': [{\n          'type': 'field_dropdown',\n          'name': 'NAME',\n          'options': Blockly.utils.getcustom_colorutilsOptions\n        },\n        {\n          'type': 'input_value',\n          'name': 'hue'\n        }, {\n          'type': 'input_value',\n          'name': 'val'\n        }, {\n          'type': 'input_value',\n          'name': 'sat'\n        },\n      ],\n      'output': null,\n      'inputsInline': true,\n      'colour': \"#0FB1D2\",\n    };\n  }\n}\n\nBlockly.Python[\"custom_colorutils_hsv2rgb\"] = function(block) {\n  var varname = block.getFieldValue('NAME') || '_';\n  var hue = Blockly.Python.valueToCode(block, 'hue', Blockly.Python.ORDER_FUNCTION_CALL) || '0';\n  var val = Blockly.Python.valueToCode(block, 'val', Blockly.Python.ORDER_FUNCTION_CALL) || '0';\n  var sat = Blockly.Python.valueToCode(block, 'sat', Blockly.Python.ORDER_FUNCTION_CALL) || '0';\n  return [`${varname}.HSV2RGB(${hue}, ${val}, ${sat})`, Blockly.Python.ORDER_NONE]\n}","toolbox":"\n<category name=\"ColorUtils\" colour=\"#0FB1D2\" hidden=\"true\" toolboxitemid=\"custom_colorutils\">\n<title text=\"ColorUtils\" docsLink=\"https://github.com/m5stack\"></title>\n<block type=\"custom_colorutils_init\"/><block type=\"custom_colorutils_hsv2rgb\">\n  <value name=\"hue\">\n    <shadow type=\"math_number\">\n      <field name=\"NUM\">0</field>\n    </shadow>\n  </value>\n  <value name=\"val\">\n    <shadow type=\"math_number\">\n      <field name=\"NUM\">0</field>\n    </shadow>\n  </value>\n  <value name=\"sat\">\n    <shadow type=\"math_number\">\n      <field name=\"NUM\">0</field>\n    </shadow>\n  </value>\n</block>\n</category>\n","pyCode":"# -*- encoding: utf-8 -*-\n'''\n@File    :   ColorUtils\n@Time    :   2024/07/15\n@Author  :   \n@E-mail  :   \n@License :   MIT\n'''\n'''\n@File    :   ColorUtils\n@Time    :   2024/07/15\n@Author  :   \n@E-mail  :   \n@License :   MIT\n'''\nimport math\n\nclass ColorUtils:\n    \"\"\"! \n    \n    @en \n\n    @color #0FB1D2\n    @link https://github.com/m5stack\n    @category CUSTOM\n\n\n    \"\"\"\n\n\n    def __init__(self):\n        \"\"\"! \n        @en %1 init\n\n        \"\"\"\n        \n\n    def HSV2RGB(self,hue:int=0,val:float=0,sat:float=0) -> any :\n        \"\"\"! \n        @en HSV2RGB %1 hue %2 val %3 sat %4\n\n        @param hue\n        @param val\n        @param sat\n        \"\"\"\n        h = hue\n        s = sat\n        v = val\n        h = float(h)\n        s = float(s)\n        v = float(v)\n        h60 = h / 60.0\n        h60f = math.floor(h60)\n        hi = int(h60f) % 6\n        f = h60 - h60f\n        p = v * (1 - s)\n        q = v * (1 - f * s)\n        t = v * (1 - (1 - f) * s)\n        r, g, b = 0, 0, 0\n        if hi == 0: r, g, b = v, t, p\n        elif hi == 1: r, g, b = q, v, p\n        elif hi == 2: r, g, b = p, v, t\n        elif hi == 3: r, g, b = p, q, v\n        elif hi == 4: r, g, b = t, p, v\n        elif hi == 5: r, g, b = v, p, q\n        r, g, b = int(r * 255), int(g * 255), int(b * 255)\n        return [r, g, b]\n\n  "}]}